---
const { url } = Astro

// detect current language from URL
function getCurrentLanguage() {
  if (url.pathname.startsWith('/en/')) return 'en'
  if (url.pathname.startsWith('/zh/')) return 'zh'
  if (url.pathname === '/') return 'zh' // root path is Chinese
  return 'zh' // default
}

const currentLang = getCurrentLanguage()

// get the opposite language URL
function getToggleUrl() {
  if (currentLang === 'zh') {
    // Switch to English
    if (url.pathname === '/') return '/en/'
    if (url.pathname.startsWith('/zh/')) {
      return url.pathname.replace(/^\/zh/, '/en')
    }
    return `/en${url.pathname}`
  } else {
    // Switch to Chinese
    if (url.pathname.startsWith('/en/')) {
      const pathWithoutLang = url.pathname.replace(/^\/en/, '')
      return pathWithoutLang === '/' ? '/' : `/zh${pathWithoutLang}`
    }
    return url.pathname
  }
}

const toggleUrl = getToggleUrl()
const toggleTitle = currentLang === 'zh' ? 'Switch to English' : '切换到中文'
---

<a
  href={toggleUrl}
  class="flex items-center justify-center w-9 h-8 rounded-md transition-all duration-200 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"
  title={toggleTitle}
>
  <div class="i-ph-translate w-5 h-5"></div>
</a>
