<!DOCTYPE html>
<html lang class="mx-4">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <title>CMU 15-213 Lab0 - Kratos</title>
  <link rel="stylesheet" href="/_astro/index.B3zaAnLi.css">
<link rel="stylesheet" href="/_astro/index.Y6NSlHWR.css">
<style>[data-astro-image]{width:100%;height:auto;object-fit:var(--fit);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style></head>
  <body class="max-width dark:bg-[#333] bg-[#FBFBFBFF]"><div class="my-6 flex">
  <a href="/" class="hover:cursor-pointer opacity-100 hover:opacity-80">
    <i class="hidden">website header </i>
    <h1 class="text-4xl font-bold text-stone-800 dark:text-stone-200">
      Kratos
    </h1>
  </a>
  <div class="text-sm place-content-center inline ml-auto">
    <!--<LanguageIcon />-->
    <span class="mx-1"></span>
    <starlight-rapide-theme-select class="astro-e3sgix4a">
  <button aria-label="ok" aria-live="polite" class="sl-flex astro-e3sgix4a" title="ok">
    <svg aria-hidden="true" height="20" viewBox="0 0 24 24" width="20" class="dark:stroke-white dark:fill-white astro-e3sgix4a">
      <mask class="moon astro-e3sgix4a" id="moon-mask-" fill="yellow" stroke="red">
        <rect x="0" y="0" width="100%" height="100%" fill="white" class="astro-e3sgix4a"></rect>
        <circle cx="24" cy="10" r="6" fill="black" class="astro-e3sgix4a"></circle>
      </mask>
      <circle class="sun astro-e3sgix4a" cx="12" cy="12" r="6" mask="url(#moon-mask-)"></circle>
      <g class="sun-beams astro-e3sgix4a" stroke="black">
        <line x1="12" y1="1" x2="12" y2="3" class="astro-e3sgix4a"></line>
        <line x1="12" y1="21" x2="12" y2="23" class="astro-e3sgix4a"></line>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" class="astro-e3sgix4a"></line>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" class="astro-e3sgix4a"></line>
        <line x1="1" y1="12" x2="3" y2="12" class="astro-e3sgix4a"></line>
        <line x1="21" y1="12" x2="23" y2="12" class="astro-e3sgix4a"></line>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" class="astro-e3sgix4a"></line>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" class="astro-e3sgix4a"></line>
      </g>
    </svg>
  </button>
</starlight-rapide-theme-select>



<script type="module">const r="panda-theme";function c(e){return e==="auto"||e==="dark"||e==="light"?e:"auto"}function d(){return c(typeof localStorage<"u"&&localStorage.getItem(r))}function l(e){typeof localStorage<"u"&&localStorage.setItem(r,e==="light"||e==="dark"?e:"")}function s(){return matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}function t(e){document.documentElement.dataset.theme=e==="auto"?s():e,e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),l(e)}matchMedia("(prefers-color-scheme: light)").addEventListener("change",()=>{d()==="auto"&&t("auto")});customElements.define("starlight-rapide-theme-select",class extends HTMLElement{constructor(){super(),t(d());const a=this.querySelector("button");a?.addEventListener("click",()=>{const o=c(document.documentElement.dataset.theme),n=o==="dark"?"light":o==="light"?"dark":"auto";t(n),a?.setAttribute("aria-label",`${n} theme`)})}});</script>
  </div>
</div>
    
    <main>
      
  <a class="link mt-6" href="/">Back</a>
  <main>
    <div class="mt-6">
      <h1 class="text-4xl">CMU 15-213 Lab0</h1>
      <div class="flex sm:flex-row flex-col pb-2" style="border-bottom: 1px dashed;">
        <span class="text-sm font-normal italic">
          11 Oct, 2022
        </span>
        <div class="ml-auto flex gap-4">
          <span class="text-sm font-normal italic">
            28 min
          </span>
          <span class="text-sm font-normal italic">
            (5568 words)
          </span>
        </div>
      </div>
      <div class="w-full">
        <article class="prose dark:prose-invert prose-stone dark:prose-gray w-full mt-6 mx-auto" style="max-width: none;">
          <h1 id="概述">概述</h1>
<p>利用 C 语言实现一个队列的基本功能，包括：</p>
<ul>
<li>创建队列</li>
<li>销毁队列</li>
<li>头部入队</li>
<li>尾部入队</li>
<li>头部出队</li>
<li>获取队列长度</li>
<li>反转队列</li>
</ul>
<p>核心在于每次对队列操作前都要考虑是否为空的情况，保证代码的鲁棒性。</p>
<h2 id="头文件">头文件</h2>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.6xp1a.css"><script type="module" src="/_astro/ec.8zarh.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">#include</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">&#x3C;stdbool.h></span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">#include</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">&#x3C;stddef.h></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* element struct in queue */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">typedef</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">struct</span><span style="--0:#E1E4E8;--1:#24292E"> list_ele {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">value;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">struct</span><span style="--0:#E1E4E8;--1:#24292E"> list_ele </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">next;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">typedef</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">struct</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">head;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">tail;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">int</span><span style="--0:#E1E4E8;--1:#24292E"> size;</span><span style="--0:#99A0A6;--1:#616972"> // use the above two variable to record the size of the queue to avoid traversal</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* Create empty queue. */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#B392F0;--1:#6F42C1">queue_new</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* Free ALL storage used by queue. */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_free</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* Attempt to insert element at head of queue. */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">bool</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_insert_head</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">s</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* Attempt to insert element at tail of queue. */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">bool</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_insert_tail</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">s</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* Attempt to remove element from head of queue. */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">bool</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_remove_head</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">sp</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">size_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">bufsize</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* Return number of elements in queue. */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">size_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_size</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/* Reverse elements in queue */</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_reverse</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="#include <stdbool.h>#include <stddef.h>/* element struct in queue */typedef struct list_ele {    char *value;    struct list_ele *next;} list_ele_t;typedef struct {    list_ele_t *head;    list_ele_t *tail;    int size; // use the above two variable to record the size of the queue to avoid traversal} queue_t;/* Create empty queue. */queue_t *queue_new(void);/* Free ALL storage used by queue. */void queue_free(queue_t *q);/* Attempt to insert element at head of queue. */bool queue_insert_head(queue_t *q, const char *s);/* Attempt to insert element at tail of queue. */bool queue_insert_tail(queue_t *q, const char *s);/* Attempt to remove element from head of queue. */bool queue_remove_head(queue_t *q, char *sp, size_t bufsize);/* Return number of elements in queue. */size_t queue_size(queue_t *q);/* Reverse elements in queue */void queue_reverse(queue_t *q);"><div></div></button></div></figure></div>
<p>可以看到，在源文件的基础上，新增了尾节点和队列大小两个属性，当然也可以不加，但如果没有这两个变量，计算队列大小或者进行尾部入队操作的时间复杂度就不是常量了，而是线性增长的。</p>
<p>下面我们具体看每个函数的实现。</p>
<h2 id="创建队列">创建队列</h2>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/**</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@brief</span><span style="--0:#99A0A6;--1:#616972"> Allocates a new queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> The new queue, or NULL if memory allocation failed</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#B392F0;--1:#6F42C1">queue_new</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">q </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">malloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* What if malloc returned NULL? */</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">q->head </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">q->tail </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">q->size </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> q;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/** * @brief Allocates a new queue * @return The new queue, or NULL if memory allocation failed */queue_t *queue_new(void) {    queue_t *q = malloc(sizeof(queue_t));    /* What if malloc returned NULL? */    if (q == NULL) {        return NULL;    } else {        q->head = NULL;        q->tail = NULL;        q->size = 0;        return q;    }}"><div></div></button></div></figure></div>
<p>这一步没什么问题，主要就是分配队列空间并初始化队列的各个属性。</p>
<h2 id="销毁队列">销毁队列</h2>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/**</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@brief</span><span style="--0:#99A0A6;--1:#616972"> Frees all memory used by a queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#99A0A6;--1:#616972"> The queue to free</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_free</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* How about freeing the list elements and the strings? */</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* Free queue structure */</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">tmp;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> (q->head </span><span style="--0:#F97583;--1:#BF3441">!=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">tmp </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->head;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">q->head </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->head->next;</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(tmp->value);</span><span style="--0:#99A0A6;--1:#616972"> // free element's value</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(tmp)</span><span style="--0:#99A0A6;--1:#616972"> // free element itself</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(q);</span><span style="--0:#99A0A6;--1:#616972"> // free queue</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/** * @brief Frees all memory used by a queue * @param[in] q The queue to free */void queue_free(queue_t *q) {    /* How about freeing the list elements and the strings? */    /* Free queue structure */    if (q == NULL) {        return;    } else {        list_ele_t *tmp;        while (q->head != NULL) {            tmp = q->head;            q->head = q->head->next;            free(tmp->value); // free element&#x27;s value            free(tmp) // free element itself        }    }    free(q); // free queue}"><div></div></button></div></figure></div>
<p>如上所述，判断完队列是否为空，还需要判断队列的属性是否为空。</p>
<h2 id="头部入队">头部入队</h2>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/**</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@brief</span><span style="--0:#99A0A6;--1:#616972"> Attempts to insert an element at head of a queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* This function explicitly allocates space to create a copy of `s`.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* The inserted element points to a copy of `s`, instead of `s` itself.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#99A0A6;--1:#616972"> The queue to insert into</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">s</span><span style="--0:#99A0A6;--1:#616972"> String to be copied and inserted into the queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> true if insertion was successful</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> false if q is NULL, or memory allocation failed</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">bool</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_insert_head</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">s</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">newh;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* What should you do if the q is NULL? */</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* Don't forget to allocate space for the string and copy it */</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* What if either call to malloc returns NULL? */</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">newh </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">malloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (newh </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">newh->value </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">malloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#B392F0;--1:#6F42C1">strlen</span><span style="--0:#E1E4E8;--1:#24292E">(s) </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (newh->value </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(newh);</span><span style="--0:#99A0A6;--1:#616972"> // must free the space if malloc failed</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#B392F0;--1:#6F42C1">strcpy</span><span style="--0:#E1E4E8;--1:#24292E">(newh->value, s);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">newh->next </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->head;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">q->head </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> newh;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q->tail </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">                </span></span><span style="--0:#E1E4E8;--1:#24292E">q->tail </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> newh;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">++</span><span style="--0:#E1E4E8;--1:#24292E">q->size;</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">true</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/** * @brief Attempts to insert an element at head of a queue * * This function explicitly allocates space to create a copy of &#x60;s&#x60;. * The inserted element points to a copy of &#x60;s&#x60;, instead of &#x60;s&#x60; itself. * * @param[in] q The queue to insert into * @param[in] s String to be copied and inserted into the queue * * @return true if insertion was successful * @return false if q is NULL, or memory allocation failed */bool queue_insert_head(queue_t *q, const char *s) {    list_ele_t *newh;    /* What should you do if the q is NULL? */    if (q == NULL) {        return false;    }    /* Don&#x27;t forget to allocate space for the string and copy it */    /* What if either call to malloc returns NULL? */    newh = malloc(sizeof(list_ele_t));    if (newh == NULL) {        return false;    } else {        newh->value = malloc(sizeof(char) * (strlen(s) + 1));        if (newh->value == NULL) {            free(newh); // must free the space if malloc failed            return false;        } else {            strcpy(newh->value, s);            newh->next = q->head;            q->head = newh;            if (q->tail == NULL) {                q->tail = newh;            }            ++q->size;            return true;        }    }}"><div></div></button></div></figure></div>
<p>除了判断队列及队列元素是否为空，还要判断<code>malloc()</code>是否成功，
正常来讲，内存分配成功的话，会返回一个可以指向任意类型的指针，但该指针必须通过<code>free()</code>或者<code>realloc()</code>回收。
如果分配失败了，会返回一个空指针，我们需要对其进行判断。</p>
<h2 id="尾部入队">尾部入队</h2>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/**</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@brief</span><span style="--0:#99A0A6;--1:#616972"> Attempts to insert an element at tail of a queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* This function explicitly allocates space to create a copy of `s`.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* The inserted element points to a copy of `s`, instead of `s` itself.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#99A0A6;--1:#616972"> The queue to insert into</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">s</span><span style="--0:#99A0A6;--1:#616972"> String to be copied and inserted into the queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> true if insertion was successful</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> false if q is NULL, or memory allocation failed</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">bool</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_insert_tail</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">const</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">s</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* You need to write the complete code for this function */</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* Remember: It should operate in O(1) time */</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">newt;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* What should you do if the q is NULL? */</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* Don't forget to allocate space for the string and copy it */</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* What if either call to malloc returns NULL? */</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">newt </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">malloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (newt </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">newt->value </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">malloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#B392F0;--1:#6F42C1">strlen</span><span style="--0:#E1E4E8;--1:#24292E">(s) </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (newt->value </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(newt);</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#B392F0;--1:#6F42C1">strcpy</span><span style="--0:#E1E4E8;--1:#24292E">(newt->value, s);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">newt->next </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q->tail </span><span style="--0:#F97583;--1:#BF3441">!=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">                </span></span><span style="--0:#E1E4E8;--1:#24292E">q->tail->next </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> newt;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">                </span></span><span style="--0:#E1E4E8;--1:#24292E">q->tail </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> newt;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">                </span></span><span style="--0:#E1E4E8;--1:#24292E">q->head </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> newt;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">                </span></span><span style="--0:#E1E4E8;--1:#24292E">q->tail </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> newt;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">++</span><span style="--0:#E1E4E8;--1:#24292E">q->size;</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">true</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/** * @brief Attempts to insert an element at tail of a queue * * This function explicitly allocates space to create a copy of &#x60;s&#x60;. * The inserted element points to a copy of &#x60;s&#x60;, instead of &#x60;s&#x60; itself. * * @param[in] q The queue to insert into * @param[in] s String to be copied and inserted into the queue * * @return true if insertion was successful * @return false if q is NULL, or memory allocation failed */bool queue_insert_tail(queue_t *q, const char *s) {    /* You need to write the complete code for this function */    /* Remember: It should operate in O(1) time */    list_ele_t *newt;    /* What should you do if the q is NULL? */    if (q == NULL) {        return false;    }    /* Don&#x27;t forget to allocate space for the string and copy it */    /* What if either call to malloc returns NULL? */    newt = malloc(sizeof(list_ele_t));    if (newt == NULL) {        return false;    } else {        newt->value = malloc(sizeof(char) * (strlen(s) + 1));        if (newt->value == NULL) {            free(newt);            return false;        } else {            strcpy(newt->value, s);            newt->next = NULL;            if (q->tail != NULL) {                q->tail->next = newt;                q->tail = newt;            } else {                q->head = newt;                q->tail = newt;            }            ++q->size;            return true;        }    }}"><div></div></button></div></figure></div>
<p>这一步和头部入队类似，不同点在于需要对尾节点是否存在进行判断，而头部入队时是不需要判断头节点是否存在的，因为必然要进行重新分配且不需要对其执行查找下一个节点的操作。</p>
<h2 id="头部出队">头部出队</h2>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/**</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@brief</span><span style="--0:#99A0A6;--1:#616972"> Attempts to remove an element from head of a queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* If removal succeeds, this function frees all memory used by the</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* removed list element and its string value before returning.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* If removal succeeds and `buf` is non-NULL, this function copies up to</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* `bufsize - 1` characters from the removed string into `buf`, and writes</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* a null terminator '\0' after the copied string.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">]  </span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#99A0A6;--1:#616972">       The queue to remove from</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">out</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">buf</span><span style="--0:#99A0A6;--1:#616972">     Output buffer to write a string value into</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">]  </span><span style="--0:#FFAB70;--1:#AE4B07">bufsize</span><span style="--0:#99A0A6;--1:#616972"> Size of the buffer `buf` points to</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> true if removal succeeded</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> false if q is NULL or empty</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">bool</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_remove_head</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">buf</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">size_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">bufsize</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q->head </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">false</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">temp </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->head;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">q->head </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->head->next;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (buf </span><span style="--0:#F97583;--1:#BF3441">!=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#B392F0;--1:#6F42C1">strncpy</span><span style="--0:#E1E4E8;--1:#24292E">(buf, temp->value, bufsize </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#FFAB70;--1:#AE4B07">buf</span><span style="--0:#E1E4E8;--1:#24292E">[bufsize </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">'</span><span style="--0:#79B8FF;--1:#005CC5">\0</span><span style="--0:#9ECBFF;--1:#032F62">'</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(temp->value);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(temp);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">--</span><span style="--0:#E1E4E8;--1:#24292E">q->size;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">true</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/** * @brief Attempts to remove an element from head of a queue * * If removal succeeds, this function frees all memory used by the * removed list element and its string value before returning. * * If removal succeeds and &#x60;buf&#x60; is non-NULL, this function copies up to * &#x60;bufsize - 1&#x60; characters from the removed string into &#x60;buf&#x60;, and writes * a null terminator &#x27;\0&#x27; after the copied string. * * @param[in]  q       The queue to remove from * @param[out] buf     Output buffer to write a string value into * @param[in]  bufsize Size of the buffer &#x60;buf&#x60; points to * * @return true if removal succeeded * @return false if q is NULL or empty */bool queue_remove_head(queue_t *q, char *buf, size_t bufsize) {    if (q == NULL) {        return false;    }    if (q->head == NULL) {        return false;    } else {        list_ele_t *temp = q->head;        q->head = q->head->next;        if (buf != NULL) {            strncpy(buf, temp->value, bufsize - 1);            buf[bufsize - 1] = &#x27;\0&#x27;;        }        free(temp->value);        free(temp);        --q->size;    }    return true;}"><div></div></button></div></figure></div>
<p>这里注意一下<code>strncpy</code>的用法就好了，要保证<code>buf</code>是 C-Style 的字符数组。</p>
<h2 id="获取队列长度">获取队列长度</h2>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/**</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@brief</span><span style="--0:#99A0A6;--1:#616972"> Returns the number of elements in a queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* This function runs in O(1) time.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#99A0A6;--1:#616972"> The queue to examine</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@return</span><span style="--0:#99A0A6;--1:#616972"> the number of elements in the queue, or</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*         0 if q is NULL or empty</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">size_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_size</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* You need to write the code for this function */</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* Remember: It should operate in O(1) time */</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> q->size;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/** * @brief Returns the number of elements in a queue * * This function runs in O(1) time. * * @param[in] q The queue to examine * * @return the number of elements in the queue, or *         0 if q is NULL or empty */size_t queue_size(queue_t *q) {    /* You need to write the code for this function */    /* Remember: It should operate in O(1) time */    if (q == NULL) {        return 0;    } else {        return q->size;    }}"><div></div></button></div></figure></div>
<p>这没什么好说的，在前面执行入队、出队的时候不要忘记修改<code>size</code>的值就可以，这里只需要直接返回，而不需要通过遍历队列的方式去计算。</p>
<h2 id="反转队列">反转队列</h2>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">/**</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@brief</span><span style="--0:#99A0A6;--1:#616972"> Reverse the elements in a queue</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* This function does not allocate or free any list elements, i.e. it does</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* not call malloc or free, including inside helper functions. Instead, it</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* rearranges the existing elements of the queue.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">* </span><span style="--0:#F97583;--1:#BF3441">@param</span><span style="--0:#99A0A6;--1:#616972">[</span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#99A0A6;--1:#616972">] </span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#99A0A6;--1:#616972"> The queue to reverse</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972"> </span></span><span style="--0:#99A0A6;--1:#616972">*/</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">queue_reverse</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">queue_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#FFAB70;--1:#AE4B07">q</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#99A0A6;--1:#616972">    </span></span><span style="--0:#99A0A6;--1:#616972">/* You need to write the code for this function */</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> (q </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> q->head </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">} </span><span style="--0:#F97583;--1:#BF3441">else</span><span style="--0:#E1E4E8;--1:#24292E"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">oldHead </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->head;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">oldTail </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->tail;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">temp </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> q->head;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">prev </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">list_ele_t</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">next </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> (temp </span><span style="--0:#F97583;--1:#BF3441">!=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">next </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> temp->next;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">temp->next </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> prev;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">prev </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> temp;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">            </span></span><span style="--0:#E1E4E8;--1:#24292E">temp </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> next;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">q->head </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> oldTail;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">q->tail </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> oldHead;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/** * @brief Reverse the elements in a queue * * This function does not allocate or free any list elements, i.e. it does * not call malloc or free, including inside helper functions. Instead, it * rearranges the existing elements of the queue. * * @param[in] q The queue to reverse */void queue_reverse(queue_t *q) {    /* You need to write the code for this function */    if (q == NULL || q->head == NULL) {        return;    } else {        list_ele_t *oldHead = q->head;        list_ele_t *oldTail = q->tail;        list_ele_t *temp = q->head;        list_ele_t *prev = NULL;        list_ele_t *next = NULL;        while (temp != NULL) {            next = temp->next;            temp->next = prev;            prev = temp;            temp = next;        }        q->head = oldTail;        q->tail = oldHead;    }}"><div></div></button></div></figure></div>
<p>经典的反转链表，这里就不赘述了。</p>
<h2 id="测试">测试</h2>
<p>一共是提供了十五组测试用例，满分一百，包括了对各个函数及其性能的测试(测试尾部入队 10000 个元素)，还有鲁棒性测试（释放空队列的空间，从空队列中移除头部元素等），还是比较全面的。</p>
        </article>
      </div>
      <div class="mt-9 flex text-sm font-italic opacity-80">
        <span class="ml-auto">
              Posted at 11 Oct, 2022
            </span>
      </div>
    </div>
  </main>

    </main>
  </body></html>